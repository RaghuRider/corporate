---
ID: "1a5e6a2c-6b82-420a-a8ab-a9ad7bbdf73b"
Parent: "cdd7e9dc-6bbd-4c64-89ae-1e1dc449b940"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Themes/AIE/AIE Corporate Site/AIEnterprise/Scripts/mobile-menu-library"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/1A5E6A2C6B82420AA8ABA9AD7BBDF73B.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "44748299-65ae-431e-83f5-e541686ccf36"
  Value: ZnVuY3Rpb24gc3VwcG9ydHNUcmFuc2l0aW9ucygpIHsNCglyZXR1cm4gZ2V0U3VwcG9ydGVkVHJhbnNpdGlvbigpICE9ICcnOw0KfQ0KDQpmdW5jdGlvbiBnZXRTdXBwb3J0ZWRUcmFuc2l0aW9uKCkgew0KCXZhciBiID0gZG9jdW1lbnQuYm9keSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsDQogICAgICAgIHMgPSBiLnN0eWxlLA0KICAgICAgICBwID0gJ3RyYW5zaXRpb24nOw0KDQogICAgaWYgKHR5cGVvZiBzW3BdID09ICdzdHJpbmcnKSB7IHJldHVybiBwOyB9DQoNCiAgICAvLyBUZXN0cyBmb3IgdmVuZG9yIHNwZWNpZmljIHByb3ANCiAgICB2YXIgdiA9IFsnTW96JywgJ3dlYmtpdCcsICdXZWJraXQnLCAnS2h0bWwnLCAnTycsICdtcyddOw0KICAgIHAgPSBwLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcC5zdWJzdHIoMSk7DQoNCiAgICBmb3IgKHZhciBpPTA7IGk8di5sZW5ndGg7IGkrKykgew0KICAgICAgICBpZiAodHlwZW9mIHNbdltpXSArIHBdID09ICdzdHJpbmcnKSB7IHJldHVybiB0cnVlOyB9DQogICAgfQ0KDQogICAgcmV0dXJuICcnOw0KfQ0Kd2luZG93LnN1cHBvcnRlZFRyYW5zaXRpb24gPSBnZXRTdXBwb3J0ZWRUcmFuc2l0aW9uKCk7DQp3aW5kb3cuc3VwcG9ydHNUcmFuc2l0aW9ucyA9IHN1cHBvcnRzVHJhbnNpdGlvbnMoKTsNCg0KZnVuY3Rpb24gc3VwcG9ydHNBbmltYXRpb25zKCkgew0KCXJldHVybiBnZXRTdXBwb3J0ZWRBbmltYXRpb24oKSAhPSAnJzsNCn0NCg0KZnVuY3Rpb24gZ2V0U3VwcG9ydGVkQW5pbWF0aW9uKCkgew0KCXZhciB0LA0KCQllbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImZha2VlbGVtZW50Iik7DQoNCgl2YXIgYW5pbWF0aW9ucyA9IHsNCgkJImFuaW1hdGlvbiIgICAgICA6ICJhbmltYXRpb25lbmQiLA0KCQkiT0FuaW1hdGlvbiIgICAgIDogIm9BbmltYXRpb25FbmQiLA0KCQkiTW96QW5pbWF0aW9uIiAgIDogImFuaW1hdGlvbmVuZCIsDQoJCSJXZWJraXRBbmltYXRpb24iOiAid2Via2l0QW5pbWF0aW9uRW5kIiwNCgkJJ21zQW5pbWF0aW9uJyA6ICdNU0FuaW1hdGlvbkVuZCcNCgl9Ow0KDQoJZm9yICh0IGluIGFuaW1hdGlvbnMpew0KCQlpZiAoZWwuc3R5bGVbdF0gIT09IHVuZGVmaW5lZCkgew0KCQkJcmV0dXJuIHQ7DQoJCX0NCgl9DQoJcmV0dXJuICcnOw0KfQ0Kd2luZG93LnN1cHBvcnRlZEFuaW1hdGlvbiA9IGdldFN1cHBvcnRlZEFuaW1hdGlvbigpOw0Kd2luZG93LnN1cHBvcnRzQW5pbWF0aW9ucyA9IHN1cHBvcnRzQW5pbWF0aW9ucygpOw0KDQpmdW5jdGlvbiBnZXRNb2JpbGVNZW51VHlwZSgpIHsNCglpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpdGUtaGVhZGVyJykpIHJldHVybiAnZGVmYXVsdCc7DQoJdmFyIG0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZS1oZWFkZXInKS5jbGFzc05hbWUubWF0Y2goL21vYmlsZS1tZW51LWxheW91dC0oW2EtekEtWjAtOV0rKS8pOw0KCXdpbmRvdy5nZW1Nb2JpbGVNZW51VHlwZSA9IG0gPyBtWzFdIDogJ2RlZmF1bHQnOw0KCXJldHVybiB3aW5kb3cuZ2VtTW9iaWxlTWVudVR5cGU7DQp9DQpnZXRNb2JpbGVNZW51VHlwZSgpOw0KDQooZnVuY3Rpb24oKSB7DQoJdmFyIGxvZ29GaXhUaW1lb3V0ID0gZmFsc2U7DQoNCglmdW5jdGlvbiBnZXRFbGVtZW50UG9zaXRpb24oZWxlbSkgew0KCQl2YXIgdyA9IGVsZW0ub2Zmc2V0V2lkdGgsDQoJCQloID0gZWxlbS5vZmZzZXRIZWlnaHQsDQoJCQlsID0gMCwNCgkJCXQgPSAwOw0KDQoJCXdoaWxlIChlbGVtKSB7DQoJCQlsICs9IGVsZW0ub2Zmc2V0TGVmdDsNCgkJCXQgKz0gZWxlbS5vZmZzZXRUb3A7DQoJCQllbGVtID0gZWxlbS5vZmZzZXRQYXJlbnQ7DQoJCX0NCgkJcmV0dXJuIHsibGVmdCI6bCwgInRvcCI6dCwgIndpZHRoIjogdywgImhlaWdodCI6aH07DQoJfQ0KDQoJZnVuY3Rpb24gZml4TWVudUxvZ29Qb3NpdGlvbigpIHsNCgkJaWYgKGxvZ29GaXhUaW1lb3V0KSB7DQoJCQljbGVhclRpbWVvdXQobG9nb0ZpeFRpbWVvdXQpOw0KCQl9DQoNCgkJdmFyIGhlYWRlck1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2l0ZS1oZWFkZXIgLmhlYWRlci1tYWluJyk7DQoJCWlmIChoZWFkZXJNYWluID09IG51bGwpIHsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCXZhciBoZWFkZXJNYWluQ2xhc3MgPSBoZWFkZXJNYWluLmNsYXNzTmFtZTsNCgkJaWYgKGhlYWRlck1haW5DbGFzcy5pbmRleE9mKCdsb2dvLXBvc2l0aW9uLW1lbnVfY2VudGVyJykgPT0gLTEgfHwgaGVhZGVyTWFpbkNsYXNzLmluZGV4T2YoJ2hlYWRlci1sYXlvdXQtZnVsbHdpZHRoX2hhbWJ1cmdlcicpICE9IC0xIHx8IGhlYWRlck1haW5DbGFzcy5pbmRleE9mKCdoZWFkZXItbGF5b3V0LXZlcnRpY2FsJykgIT0gLTEpIHsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCWxvZ29GaXhUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsNCgkJCXZhciBwYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2UnKSwNCgkJCQlwcmltYXJ5TWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmltYXJ5LW1lbnUnKSwNCgkJCQlwcmltYXJ5TmF2aWdhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmltYXJ5LW5hdmlnYXRpb24nKSwNCgkJCQl3aW5kb3dXaWR0aCA9IHBhZ2Uub2Zmc2V0V2lkdGgsDQoJCQkJcGFnZUNvbXB1dGVkU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUocGFnZSwgbnVsbCksDQoJCQkJcGFnZU1hcmdpbiA9IHBhcnNlRmxvYXQocGFnZUNvbXB1dGVkU3R5bGVzWydtYXJnaW5MZWZ0J10pOw0KDQoJCQlpZiAoaXNOYU4ocGFnZU1hcmdpbikpIHsNCgkJCQlwYWdlTWFyZ2luID0gMDsNCgkJCX0NCg0KCQkJaWYgKGhlYWRlck1haW5DbGFzcy5pbmRleE9mKCdoZWFkZXItbGF5b3V0LWZ1bGx3aWR0aCcpICE9IC0xKSB7DQoJCQkJdmFyIGxvZ29JdGVtID0gcHJpbWFyeU1lbnUucXVlcnlTZWxlY3RvcignLm1lbnUtaXRlbS1sb2dvJyksDQoJCQkJCWxhc3RJdGVtID0gcHJpbWFyeU5hdmlnYXRpb24ucXVlcnlTZWxlY3RvcignI3ByaW1hcnktbWVudSA+IGxpOmxhc3QtY2hpbGQnKTsNCg0KCQkJCXByaW1hcnlNZW51LnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkJCQlsb2dvSXRlbS5zdHlsZS5tYXJnaW5MZWZ0ID0gJyc7DQoJCQkJbG9nb0l0ZW0uc3R5bGUubWFyZ2luUmlnaHQgPSAnJzsNCg0KCQkJCWlmICh3aW5kb3dXaWR0aCA8IDEyMTIpIHsNCgkJCQkJcmV0dXJuOw0KCQkJCX0NCg0KCQkJCXByaW1hcnlNZW51LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQoJCQkJdmFyIHBhZ2VDZW50ZXIgPSB3aW5kb3dXaWR0aCAvIDIgKyBwYWdlTWFyZ2luLA0KCQkJCQlsb2dvT2Zmc2V0ID0gZ2V0RWxlbWVudFBvc2l0aW9uKGxvZ29JdGVtKSwNCgkJCQkJb2Zmc2V0ID0gcGFnZUNlbnRlciAtIGxvZ29PZmZzZXQubGVmdCAtIGxvZ29JdGVtLm9mZnNldFdpZHRoIC8gMjsNCg0KCQkJCWxvZ29JdGVtLnN0eWxlLm1hcmdpbkxlZnQgPSBvZmZzZXQgKyAncHgnOw0KDQoJCQkJdmFyIHByaW1hcnlNZW51T2Zmc2V0V2lkdGggPSBwcmltYXJ5TWVudS5vZmZzZXRXaWR0aCwNCgkJCQkJcHJpbWFyeU1lbnVPZmZzZXRMZWZ0ID0gZ2V0RWxlbWVudFBvc2l0aW9uKHByaW1hcnlNZW51KS5sZWZ0LA0KCQkJCQlsYXN0SXRlbU9mZnNldFdpZHRoID0gbGFzdEl0ZW0ub2Zmc2V0V2lkdGgsDQoJCQkJCWxhc3RJdGVtT2Zmc2V0TGVmdCA9IGdldEVsZW1lbnRQb3NpdGlvbihsYXN0SXRlbSkubGVmdCwNCgkJCQkJcmlnaHRJdGVtc09mZnNldCA9IHByaW1hcnlNZW51T2Zmc2V0V2lkdGggLSBsYXN0SXRlbU9mZnNldExlZnQgLSBsYXN0SXRlbU9mZnNldFdpZHRoICsgcHJpbWFyeU1lbnVPZmZzZXRMZWZ0Ow0KDQoJCQkJbG9nb0l0ZW0uc3R5bGUubWFyZ2luUmlnaHQgPSByaWdodEl0ZW1zT2Zmc2V0ICsgJ3B4JzsNCgkJCX0gZWxzZSB7DQoJCQkJaWYgKHdpbmRvd1dpZHRoIDwgMTIxMikgew0KCQkJCQlwcmltYXJ5TmF2aWdhdGlvbi5zdHlsZS50ZXh0QWxpZ24gPSAnJzsNCgkJCQkJcHJpbWFyeU1lbnUuc3R5bGUucG9zaXRpb24gPSAnJzsNCgkJCQkJcHJpbWFyeU1lbnUuc3R5bGUubGVmdCA9ICcnOw0KCQkJCQlyZXR1cm47DQoJCQkJfQ0KDQoJCQkJcHJpbWFyeU5hdmlnYXRpb24uc3R5bGUudGV4dEFsaWduID0gJ2xlZnQnOw0KCQkJCXByaW1hcnlNZW51LnN0eWxlLmxlZnQgPSAwICsgJ3B4JzsNCg0KCQkJCXZhciBwYWdlQ2VudGVyID0gd2luZG93V2lkdGggLyAyLA0KCQkJCQlwcmltYXJ5TWVudU9mZnNldExlZnQgPSBnZXRFbGVtZW50UG9zaXRpb24ocHJpbWFyeU1lbnUpLmxlZnQsDQoJCQkJCWxvZ29PZmZzZXQgPSBnZXRFbGVtZW50UG9zaXRpb24oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NpdGUtaGVhZGVyIC5oZWFkZXItbWFpbiAjcHJpbWFyeS1uYXZpZ2F0aW9uIC5tZW51LWl0ZW0tbG9nbycpKSwNCgkJCQkJcGFnZU9mZnNldCA9IGdldEVsZW1lbnRQb3NpdGlvbihwYWdlKSwNCgkJCQkJb2Zmc2V0ID0gcGFnZUNlbnRlciAtIChsb2dvT2Zmc2V0LmxlZnQgLSBwYWdlT2Zmc2V0LmxlZnQpIC0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NpdGUtaGVhZGVyIC5oZWFkZXItbWFpbiAjcHJpbWFyeS1uYXZpZ2F0aW9uIC5tZW51LWl0ZW0tbG9nbycpLm9mZnNldFdpZHRoIC8gMjsNCg0KCQkJCWlmIChwcmltYXJ5TWVudU9mZnNldExlZnQgKyBvZmZzZXQgPj0gMCkgew0KCQkJCQlwcmltYXJ5TWVudS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7DQoJCQkJCXByaW1hcnlNZW51LnN0eWxlLmxlZnQgPSBvZmZzZXQgKyAncHgnOw0KCQkJCX0gZWxzZSB7DQoJCQkJCXByaW1hcnlNZW51LnN0eWxlLnBvc2l0aW9uID0gJyc7DQoJCQkJCXByaW1hcnlNZW51LnN0eWxlLmxlZnQgPSAnJzsNCgkJCQl9DQoJCQl9DQoJCX0sIDUwKTsNCgl9DQoNCgl3aW5kb3cuZml4TWVudUxvZ29Qb3NpdGlvbiA9IGZpeE1lbnVMb2dvUG9zaXRpb247DQoNCgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQoJCXdpbmRvdy5maXhNZW51TG9nb1Bvc2l0aW9uKCk7DQoJfSwgZmFsc2UpOw0KDQp9KSgpOw0KDQoNCihmdW5jdGlvbigkKSB7DQogICAgLyogUFJJTUFSWSBNRU5VICovDQoNCgl2YXIgaXNWZXJ0aWNhbE1lbnUgPSAkKCcuaGVhZGVyLW1haW4nKS5oYXNDbGFzcygnaGVhZGVyLWxheW91dC12ZXJ0aWNhbCcpLA0KCQlpc0hhbWJ1cmdlck1lbnUgPSAkKCcuaGVhZGVyLW1haW4nKS5oYXNDbGFzcygnaGVhZGVyLWxheW91dC1mdWxsd2lkdGhfaGFtYnVyZ2VyJyksDQoJCWlzUGVyc3BlY3RpdmVNZW51ID0gJCgnI3RoZWdlbS1wZXJzcGVjdGl2ZScpLmxlbmd0aCA+IDA7DQoNCgkkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkgew0KCSAgICB3aW5kb3cudXBkYXRlR2VtQ2xpZW50U2l6ZShmYWxzZSk7DQoJCXdpbmRvdy51cGRhdGVHZW1Jbm5lclNpemUoKTsNCgl9KTsNCg0KCXdpbmRvdy5tZW51UmVzaXplVGltZW91dEhhbmRsZXIgPSBmYWxzZTsNCg0KICAgIHZhciBtZWdhTWVudVNldHRpbmdzID0ge307DQoNCiAgICBmdW5jdGlvbiBnZXRPZmZzZXQoZWxlbSkgew0KCQlpZiAoZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QgJiYgd2luZG93LmdlbUJyb3dzZXIucGxhdGZvcm0ubmFtZSAhPSAnaW9zJyl7DQoJCQl2YXIgYm91bmQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLA0KCQkJCWh0bWwgPSBlbGVtLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LA0KCQkJCWh0bWxTY3JvbGwgPSBnZXRTY3JvbGwoaHRtbCksDQoJCQkJZWxlbVNjcm9sbHMgPSBnZXRTY3JvbGxzKGVsZW0pLA0KCQkJCWlzRml4ZWQgPSAoc3R5bGVTdHJpbmcoZWxlbSwgJ3Bvc2l0aW9uJykgPT0gJ2ZpeGVkJyk7DQoJCQlyZXR1cm4gew0KCQkJCXg6IHBhcnNlSW50KGJvdW5kLmxlZnQpICsgZWxlbVNjcm9sbHMueCArICgoaXNGaXhlZCkgPyAwIDogaHRtbFNjcm9sbC54KSAtIGh0bWwuY2xpZW50TGVmdCwNCgkJCQl5OiBwYXJzZUludChib3VuZC50b3ApICArIGVsZW1TY3JvbGxzLnkgKyAoKGlzRml4ZWQpID8gMCA6IGh0bWxTY3JvbGwueSkgLSBodG1sLmNsaWVudFRvcA0KCQkJfTsNCgkJfQ0KDQoJCXZhciBlbGVtZW50ID0gZWxlbSwgcG9zaXRpb24gPSB7eDogMCwgeTogMH07DQoJCWlmIChpc0JvZHkoZWxlbSkpIHJldHVybiBwb3NpdGlvbjsNCg0KCQl3aGlsZSAoZWxlbWVudCAmJiAhaXNCb2R5KGVsZW1lbnQpKXsNCgkJCXBvc2l0aW9uLnggKz0gZWxlbWVudC5vZmZzZXRMZWZ0Ow0KCQkJcG9zaXRpb24ueSArPSBlbGVtZW50Lm9mZnNldFRvcDsNCg0KCQkJaWYgKHdpbmRvdy5nZW1Ccm93c2VyLm5hbWUgPT0gJ2ZpcmVmb3gnKXsNCgkJCQlpZiAoIWJvcmRlckJveChlbGVtZW50KSl7DQoJCQkJCXBvc2l0aW9uLnggKz0gbGVmdEJvcmRlcihlbGVtZW50KTsNCgkJCQkJcG9zaXRpb24ueSArPSB0b3BCb3JkZXIoZWxlbWVudCk7DQoJCQkJfQ0KCQkJCXZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7DQoJCQkJaWYgKHBhcmVudCAmJiBzdHlsZVN0cmluZyhwYXJlbnQsICdvdmVyZmxvdycpICE9ICd2aXNpYmxlJyl7DQoJCQkJCXBvc2l0aW9uLnggKz0gbGVmdEJvcmRlcihwYXJlbnQpOw0KCQkJCQlwb3NpdGlvbi55ICs9IHRvcEJvcmRlcihwYXJlbnQpOw0KCQkJCX0NCgkJCX0gZWxzZSBpZiAoZWxlbWVudCAhPSBlbGVtICYmIHdpbmRvdy5nZW1Ccm93c2VyLm5hbWUgPT0gJ3NhZmFyaScpew0KCQkJCXBvc2l0aW9uLnggKz0gbGVmdEJvcmRlcihlbGVtZW50KTsNCgkJCQlwb3NpdGlvbi55ICs9IHRvcEJvcmRlcihlbGVtZW50KTsNCgkJCX0NCg0KCQkJZWxlbWVudCA9IGVsZW1lbnQub2Zmc2V0UGFyZW50Ow0KCQl9DQoJCWlmICh3aW5kb3cuZ2VtQnJvd3Nlci5uYW1lID09ICdmaXJlZm94JyAmJiAhYm9yZGVyQm94KGVsZW0pKXsNCgkJCXBvc2l0aW9uLnggLT0gbGVmdEJvcmRlcihlbGVtKTsNCgkJCXBvc2l0aW9uLnkgLT0gdG9wQm9yZGVyKGVsZW0pOw0KCQl9DQoJCXJldHVybiBwb3NpdGlvbjsNCgl9Ow0KDQoJZnVuY3Rpb24gZ2V0U2Nyb2xsKGVsZW0pew0KCQlyZXR1cm4ge3g6IHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCwgeTogd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3B9Ow0KCX07DQoNCglmdW5jdGlvbiBnZXRTY3JvbGxzKGVsZW0pew0KCQl2YXIgZWxlbWVudCA9IGVsZW0ucGFyZW50Tm9kZSwgcG9zaXRpb24gPSB7eDogMCwgeTogMH07DQoJCXdoaWxlIChlbGVtZW50ICYmICFpc0JvZHkoZWxlbWVudCkpew0KCQkJcG9zaXRpb24ueCArPSBlbGVtZW50LnNjcm9sbExlZnQ7DQoJCQlwb3NpdGlvbi55ICs9IGVsZW1lbnQuc2Nyb2xsVG9wOw0KCQkJZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTsNCgkJfQ0KCQlyZXR1cm4gcG9zaXRpb247DQoJfTsNCg0KCWZ1bmN0aW9uIHN0eWxlU3RyaW5nKGVsZW1lbnQsIHN0eWxlKSB7DQoJCXJldHVybiAkKGVsZW1lbnQpLmNzcyhzdHlsZSk7DQoJfTsNCg0KCWZ1bmN0aW9uIHN0eWxlTnVtYmVyKGVsZW1lbnQsIHN0eWxlKXsNCgkJcmV0dXJuIHBhcnNlSW50KHN0eWxlU3RyaW5nKGVsZW1lbnQsIHN0eWxlKSkgfHwgMDsNCgl9Ow0KDQoJZnVuY3Rpb24gYm9yZGVyQm94KGVsZW1lbnQpew0KCQlyZXR1cm4gc3R5bGVTdHJpbmcoZWxlbWVudCwgJy1tb3otYm94LXNpemluZycpID09ICdib3JkZXItYm94JzsNCgl9Ow0KDQoJZnVuY3Rpb24gdG9wQm9yZGVyKGVsZW1lbnQpew0KCQlyZXR1cm4gc3R5bGVOdW1iZXIoZWxlbWVudCwgJ2JvcmRlci10b3Atd2lkdGgnKTsNCgl9Ow0KDQoJZnVuY3Rpb24gbGVmdEJvcmRlcihlbGVtZW50KXsNCgkJcmV0dXJuIHN0eWxlTnVtYmVyKGVsZW1lbnQsICdib3JkZXItbGVmdC13aWR0aCcpOw0KCX07DQoNCglmdW5jdGlvbiBpc0JvZHkoZWxlbWVudCl7DQoJCXJldHVybiAoL14oPzpib2R5fGh0bWwpJC9pKS50ZXN0KGVsZW1lbnQudGFnTmFtZSk7DQoJfTsNCg0KDQogICAgZnVuY3Rpb24gY2hlY2tNZWdhTWVudVNldHRpbmdzKCkgew0KCQlpZiAod2luZG93LmN1c3RvbU1lZ2FNZW51U2V0dGluZ3MgPT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5jdXN0b21NZWdhTWVudVNldHRpbmdzID09IG51bGwpIHsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCXZhciB1cmkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7DQoNCgkJd2luZG93LmN1c3RvbU1lZ2FNZW51U2V0dGluZ3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7DQoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0udXJscy5sZW5ndGg7IGkrKykgew0KCQkJCWlmICh1cmkubWF0Y2goaXRlbS51cmxzW2ldKSkgew0KCQkJCQltZWdhTWVudVNldHRpbmdzW2l0ZW0ubWVudUl0ZW1dID0gaXRlbS5kYXRhOw0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfQ0KDQoJZnVuY3Rpb24gZml4TWVnYU1lbnVXaXRoU2V0dGluZ3MoKSB7DQoJCWNoZWNrTWVnYU1lbnVTZXR0aW5ncygpOw0KDQoJCSQoJyNwcmltYXJ5LW1lbnUgPiBsaS5tZWdhbWVudS1lbmFibGUnKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJdmFyIG0gPSB0aGlzLmNsYXNzTmFtZS5tYXRjaCgvKG1lbnUtaXRlbS0oXGQrKSkvKTsNCgkJCWlmICghbSkgew0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJdmFyIGl0ZW1JZCA9IHBhcnNlSW50KG1bMl0pOw0KCQkJaWYgKG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXSA9PSB1bmRlZmluZWQgfHwgbWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdID09IG51bGwpIHsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCXZhciAkaXRlbSA9ICQoJz4gdWwnLCB0aGlzKTsNCg0KCQkJaWYgKG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXS5tYXNvbnJ5ICE9IHVuZGVmaW5lZCkgew0KCQkJCWlmIChtZWdhTWVudVNldHRpbmdzW2l0ZW1JZF0ubWFzb25yeSkgew0KCQkJCQkkaXRlbS5hZGRDbGFzcygnbWVnYW1lbnUtbWFzb25yeScpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSRpdGVtLnJlbW92ZUNsYXNzKCdtZWdhbWVudS1tYXNvbnJ5Jyk7DQoJCQkJfQ0KCQkJfQ0KDQoJCQlpZiAobWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdLnN0eWxlICE9IHVuZGVmaW5lZCkgew0KCQkJCSQodGhpcykucmVtb3ZlQ2xhc3MoJ21lZ2FtZW51LXN0eWxlLWRlZmF1bHQgbWVnYW1lbnUtc3R5bGUtZ3JpZCcpLmFkZENsYXNzKCdtZWdhbWVudS1zdHlsZS0nICsgbWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdLnN0eWxlKTsNCgkJCX0NCg0KCQkJdmFyIGNzcyA9IHt9Ow0KDQoJCQlpZiAobWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdLmJhY2tncm91bmRJbWFnZSAhPSB1bmRlZmluZWQpIHsNCgkJCQljc3MuYmFja2dyb3VuZEltYWdlID0gbWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdLmJhY2tncm91bmRJbWFnZTsNCgkJCX0NCg0KCQkJaWYgKG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXS5iYWNrZ3JvdW5kUG9zaXRpb24gIT0gdW5kZWZpbmVkKSB7DQoJCQkJY3NzLmJhY2tncm91bmRQb3NpdGlvbiA9IG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXS5iYWNrZ3JvdW5kUG9zaXRpb247DQoJCQl9DQoNCgkJCWlmIChtZWdhTWVudVNldHRpbmdzW2l0ZW1JZF0ucGFkZGluZyAhPSB1bmRlZmluZWQpIHsNCgkJCQljc3MucGFkZGluZyA9IG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXS5wYWRkaW5nOw0KCQkJfQ0KDQoJCQlpZiAobWVnYU1lbnVTZXR0aW5nc1tpdGVtSWRdLmJvcmRlclJpZ2h0ICE9IHVuZGVmaW5lZCkgew0KCQkJCWNzcy5ib3JkZXJSaWdodCA9IG1lZ2FNZW51U2V0dGluZ3NbaXRlbUlkXS5ib3JkZXJSaWdodDsNCgkJCX0NCg0KCQkJJGl0ZW0uY3NzKGNzcyk7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGlzUmVzcG9uc2l2ZU1lbnVWaXNpYmxlKCkgew0KCQkvLyB2YXIgbWVudVRvZ2dsZURpc3BsYXkgPSAkKCcubWVudS10b2dnbGUnKS5jc3MoJ2Rpc3BsYXknKTsNCgkJLy8gcmV0dXJuIG1lbnVUb2dnbGVEaXNwbGF5ID09ICdibG9jaycgfHwgbWVudVRvZ2dsZURpc3BsYXkgPT0gJ2lubGluZS1ibG9jayc7DQoJCXJldHVybiAkKCcucHJpbWFyeS1uYXZpZ2F0aW9uIC5tZW51LXRvZ2dsZScpLmlzKCc6dmlzaWJsZScpOw0KCX0NCgl3aW5kb3cuaXNSZXNwb25zaXZlTWVudVZpc2libGUgPSBpc1Jlc3BvbnNpdmVNZW51VmlzaWJsZTsNCg0KCWZ1bmN0aW9uIGlzVG9wQXJlYVZpc2libGUoKSB7DQoJCXJldHVybiB3aW5kb3cuZ2VtU2V0dGluZ3MudG9wQXJlYU1vYmlsZURpc2FibGUgPyB3aW5kb3cuZ2VtT3B0aW9ucy5jbGllbnRXaWR0aCA+PSA3NjggOiB0cnVlOw0KCX0NCgl3aW5kb3cuaXNUb3BBcmVhVmlzaWJsZSA9IGlzVG9wQXJlYVZpc2libGU7DQoNCglmdW5jdGlvbiBpc1ZlcnRpY2FsVG9nZ2xlVmlzaWJsZSgpIHsNCgkJcmV0dXJuIHdpbmRvdy5nZW1PcHRpb25zLmNsaWVudFdpZHRoID4gMTYwMDsNCgl9DQoNCgkkKCcjcHJpbWFyeS1tZW51ID4gbGkubWVnYW1lbnUtZW5hYmxlJykuaG92ZXIoDQoJCWZ1bmN0aW9uKCkgew0KCQkJZml4X21lZ2FtZW51X3Bvc2l0aW9uKHRoaXMpOw0KCQl9LA0KCQlmdW5jdGlvbigpIHt9DQoJKTsNCg0KCSQoJyNwcmltYXJ5LW1lbnUgPiBsaS5tZWdhbWVudS1lbmFibGU6aG92ZXInKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQlmaXhfbWVnYW1lbnVfcG9zaXRpb24odGhpcyk7DQoJfSk7DQoNCgkkKCcjcHJpbWFyeS1tZW51ID4gbGkubWVnYW1lbnUtZW5hYmxlJykuZWFjaChmdW5jdGlvbigpIHsNCgkJdmFyICRpdGVtID0gJCgnPiB1bCcsIHRoaXMpOw0KCQlpZigkaXRlbS5sZW5ndGggPT0gMCkgcmV0dXJuOw0KCQkkaXRlbS5hZGRDbGFzcygnbWVnYW1lbnUtaXRlbS1pbml0ZWQnKTsNCgl9KTsNCg0KCWZ1bmN0aW9uIGZpeF9tZWdhbWVudV9wb3NpdGlvbihlbGVtKSB7DQoJCWlmICghJCgnLm1lZ2FtZW51LWluaXRlZCcsIGVsZW0pLmxlbmd0aCAmJiBpc1Jlc3BvbnNpdmVNZW51VmlzaWJsZSgpKSB7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCg0KCQkJdmFyICRpdGVtID0gJCgnPiB1bCcsIGVsZW0pOw0KCQkJaWYoJGl0ZW0ubGVuZ3RoID09IDApIHJldHVybjsNCgkJCXZhciBzZWxmID0gJGl0ZW0uZ2V0KDApOw0KDQoJCQkkaXRlbS5hZGRDbGFzcygnbWVnYW1lbnUtaXRlbS1pbml0ZWQnKTsNCg0KCQkJdmFyIGRlZmF1bHRfaXRlbV9jc3MgPSB7DQoJCQkJd2lkdGg6ICdhdXRvJywNCgkJCQloZWlnaHQ6ICdhdXRvJw0KCQkJfTsNCg0KCQkJaWYgKCFpc1ZlcnRpY2FsTWVudSAmJiAhaXNIYW1idXJnZXJNZW51ICYmICFpc1BlcnNwZWN0aXZlTWVudSkgew0KCQkJCWRlZmF1bHRfaXRlbV9jc3MubGVmdCA9IDA7DQoJCQl9DQoNCgkJCSRpdGVtDQoJCQkJLnJlbW92ZUNsYXNzKCdtZWdhbWVudS1tYXNvbnJ5LWluaXRlZCBtZWdhbWVudS1mdWxsd2lkdGgnKQ0KCQkJCS5jc3MoZGVmYXVsdF9pdGVtX2Nzcyk7DQoNCgkJCSQoJyA+IGxpJywgJGl0ZW0pLmNzcyh7DQoJCQkJbGVmdDogMCwNCgkJCQl0b3A6IDANCgkJCX0pLmVhY2goZnVuY3Rpb24oKSB7DQoJCQkJdmFyIG9sZF93aWR0aCA9ICQodGhpcykuZGF0YSgnb2xkLXdpZHRoJykgfHwgLTE7DQoJCQkJaWYgKG9sZF93aWR0aCAhPSAtMSkgew0KCQkJCQkkKHRoaXMpLndpZHRoKG9sZF93aWR0aCkuZGF0YSgnb2xkLXdpZHRoJywgLTEpOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQlpZiAoaXNSZXNwb25zaXZlTWVudVZpc2libGUoKSkgew0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJaWYgKGlzVmVydGljYWxNZW51KSB7DQoJCQkJdmFyIGNvbnRhaW5lcl93aWR0aCA9IHdpbmRvdy5nZW1PcHRpb25zLmNsaWVudFdpZHRoIC0gJCgnI3NpdGUtaGVhZGVyLXdyYXBwZXInKS5vdXRlcldpZHRoKCk7DQoJCQl9IGVsc2UgaWYgKGlzUGVyc3BlY3RpdmVNZW51KSB7DQoJCQkJdmFyIGNvbnRhaW5lcl93aWR0aCA9IHdpbmRvdy5nZW1PcHRpb25zLmNsaWVudFdpZHRoIC0gJCgnI3ByaW1hcnktbmF2aWdhdGlvbicpLm91dGVyV2lkdGgoKTsNCgkJCX0gZWxzZSBpZiAoaXNIYW1idXJnZXJNZW51KSB7DQoJCQkJdmFyIGNvbnRhaW5lcl93aWR0aCA9IHdpbmRvdy5nZW1PcHRpb25zLmNsaWVudFdpZHRoIC0gJCgnI3ByaW1hcnktbWVudScpLm91dGVyV2lkdGgoKTsNCgkJCX0gZWxzZSB7DQoJCQkJdmFyICRjb250YWluZXIgPSAkaXRlbS5jbG9zZXN0KCcuaGVhZGVyLW1haW4nKSwNCgkJCQkJY29udGFpbmVyX3dpZHRoID0gJGNvbnRhaW5lci53aWR0aCgpLA0KCQkJCQljb250YWluZXJfcGFkZGluZ19sZWZ0ID0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ3BhZGRpbmctbGVmdCcpKSwNCgkJCQkJY29udGFpbmVyX3BhZGRpbmdfcmlnaHQgPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygncGFkZGluZy1yaWdodCcpKSwNCgkJCQkJcGFyZW50X3dpZHRoID0gJGl0ZW0ucGFyZW50KCkub3V0ZXJXaWR0aCgpOw0KCQkJfQ0KDQoJCQl2YXIgbWVnYW1lbnVfd2lkdGggPSAkaXRlbS5vdXRlcldpZHRoKCk7DQoNCgkJCWlmIChtZWdhbWVudV93aWR0aCA+IGNvbnRhaW5lcl93aWR0aCkgew0KCQkJCW1lZ2FtZW51X3dpZHRoID0gY29udGFpbmVyX3dpZHRoOw0KCQkJCXZhciBuZXdfbWVnYW1lbnVfd2lkdGggPSBjb250YWluZXJfd2lkdGggLSBwYXJzZUludCgkaXRlbS5jc3MoJ3BhZGRpbmctbGVmdCcpKSAtIHBhcnNlSW50KCRpdGVtLmNzcygncGFkZGluZy1yaWdodCcpKTsNCgkJCQl2YXIgY29sdW1ucyA9ICRpdGVtLmRhdGEoJ21lZ2FtZW51LWNvbHVtbnMnKSB8fCA0Ow0KCQkJCXZhciBjb2x1bW5fd2lkdGggPSBwYXJzZUZsb2F0KG5ld19tZWdhbWVudV93aWR0aCAtIGNvbHVtbnMgKiBwYXJzZUludCgkKCcgPiBsaS5tZW51LWl0ZW06Zmlyc3QnLCAkaXRlbSkuY3NzKCdtYXJnaW4tbGVmdCcpKSkgLyBjb2x1bW5zOw0KCQkJCXZhciBjb2x1bW5fd2lkdGhfaW50ID0gcGFyc2VJbnQoY29sdW1uX3dpZHRoKTsNCgkJCQkkKCcgPiBsaScsICRpdGVtKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJCQkkKHRoaXMpLmRhdGEoJ29sZC13aWR0aCcsICQodGhpcykud2lkdGgoKSkuY3NzKCd3aWR0aCcsIGNvbHVtbl93aWR0aF9pbnQpOw0KCQkJCX0pOw0KCQkJCSRpdGVtLmFkZENsYXNzKCdtZWdhbWVudS1mdWxsd2lkdGgnKS53aWR0aChuZXdfbWVnYW1lbnVfd2lkdGggLSAoY29sdW1uX3dpZHRoIC0gY29sdW1uX3dpZHRoX2ludCkgKiBjb2x1bW5zKTsNCgkJCX0NCg0KCQkJaWYgKCFpc1ZlcnRpY2FsTWVudSAmJiAhaXNIYW1idXJnZXJNZW51ICYmICFpc1BlcnNwZWN0aXZlTWVudSkgew0KCQkJCWlmIChtZWdhbWVudV93aWR0aCA+IHBhcmVudF93aWR0aCkgew0KCQkJCQl2YXIgbGVmdCA9IC0obWVnYW1lbnVfd2lkdGggLSBwYXJlbnRfd2lkdGgpIC8gMjsNCgkJCQl9IGVsc2Ugew0KCQkJCQl2YXIgbGVmdCA9IDA7DQoJCQkJfQ0KDQoJCQkJdmFyIGNvbnRhaW5lcl9vZmZzZXQgPSBnZXRPZmZzZXQoJGNvbnRhaW5lclswXSk7DQoJCQkJdmFyIG1lZ2FtZW51X29mZnNldCA9IGdldE9mZnNldChzZWxmKTsNCg0KCQkJCWlmICgobWVnYW1lbnVfb2Zmc2V0LnggLSBjb250YWluZXJfb2Zmc2V0LnggLSBjb250YWluZXJfcGFkZGluZ19sZWZ0ICsgbGVmdCkgPCAwKSB7DQoJCQkJCWxlZnQgPSAtKG1lZ2FtZW51X29mZnNldC54IC0gY29udGFpbmVyX29mZnNldC54IC0gY29udGFpbmVyX3BhZGRpbmdfbGVmdCk7DQoJCQkJfQ0KDQoJCQkJaWYgKChtZWdhbWVudV9vZmZzZXQueCArIG1lZ2FtZW51X3dpZHRoICsgbGVmdCkgPiAoY29udGFpbmVyX29mZnNldC54ICsgJGNvbnRhaW5lci5vdXRlcldpZHRoKCkgLSBjb250YWluZXJfcGFkZGluZ19yaWdodCkpIHsNCgkJCQkJbGVmdCAtPSAobWVnYW1lbnVfb2Zmc2V0LnggKyBtZWdhbWVudV93aWR0aCArIGxlZnQpIC0gKGNvbnRhaW5lcl9vZmZzZXQueCArICRjb250YWluZXIub3V0ZXJXaWR0aCgpIC0gY29udGFpbmVyX3BhZGRpbmdfcmlnaHQpOw0KCQkJCX0NCg0KCQkJCSRpdGVtLmNzcygnbGVmdCcsIGxlZnQpLmNzcygnbGVmdCcpOw0KCQkJfQ0KDQoJCQlpZiAoJGl0ZW0uaGFzQ2xhc3MoJ21lZ2FtZW51LW1hc29ucnknKSkgew0KCQkJCXZhciBwb3NpdGlvbnMgPSB7fSwNCgkJCQkJbWF4X2JvdHRvbSA9IDA7DQoNCgkJCQkkaXRlbS53aWR0aCgkaXRlbS53aWR0aCgpIC0gMSk7DQoJCQkJdmFyIG5ld19yb3dfaGVpZ2h0ID0gJCgnLm1lZ2FtZW51LW5ldy1yb3cnLCAkaXRlbSkub3V0ZXJIZWlnaHQoKSArIHBhcnNlSW50KCQoJy5tZWdhbWVudS1uZXctcm93JywgJGl0ZW0pLmNzcygnbWFyZ2luLWJvdHRvbScpKTsNCg0KCQkJCSQoJz4gbGkubWVudS1pdGVtJywgJGl0ZW0pLmVhY2goZnVuY3Rpb24oKSB7DQoJCQkJCXZhciBwb3MgPSAkKHRoaXMpLnBvc2l0aW9uKCk7DQoJCQkJCWlmIChwb3NpdGlvbnNbcG9zLmxlZnRdICE9IG51bGwgJiYgcG9zaXRpb25zW3Bvcy5sZWZ0XSAhPSB1bmRlZmluZWQpIHsNCgkJCQkJCXZhciB0b3BfcG9zaXRpb24gPSBwb3NpdGlvbnNbcG9zLmxlZnRdOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJdmFyIHRvcF9wb3NpdGlvbiA9IHBvcy50b3A7DQoJCQkJCX0NCgkJCQkJcG9zaXRpb25zW3Bvcy5sZWZ0XSA9IHRvcF9wb3NpdGlvbiArICQodGhpcykub3V0ZXJIZWlnaHQoKSArIG5ld19yb3dfaGVpZ2h0ICsgcGFyc2VJbnQoJCh0aGlzKS5jc3MoJ21hcmdpbi1ib3R0b20nKSk7DQoJCQkJCWlmIChwb3NpdGlvbnNbcG9zLmxlZnRdID4gbWF4X2JvdHRvbSkNCgkJCQkJCW1heF9ib3R0b20gPSBwb3NpdGlvbnNbcG9zLmxlZnRdOw0KCQkJCQkkKHRoaXMpLmNzcyh7DQoJCQkJCQlsZWZ0OiBwb3MubGVmdCwNCgkJCQkJCXRvcDogdG9wX3Bvc2l0aW9uDQoJCQkJCX0pDQoJCQkJfSk7DQoNCgkJCQkkaXRlbS5oZWlnaHQobWF4X2JvdHRvbSAtIG5ld19yb3dfaGVpZ2h0IC0gcGFyc2VJbnQoJGl0ZW0uY3NzKCdwYWRkaW5nLXRvcCcpKSAtIDEpOw0KCQkJCSRpdGVtLmFkZENsYXNzKCdtZWdhbWVudS1tYXNvbnJ5LWluaXRlZCcpOw0KCQkJfQ0KDQoJCQlpZiAoJGl0ZW0uaGFzQ2xhc3MoJ21lZ2FtZW51LWVtcHR5LXJpZ2h0JykpIHsNCgkJCQl2YXIgbWVnYV93aWR0aCA9ICRpdGVtLndpZHRoKCk7DQoJCQkJdmFyIG1heF9yaWdodHMgPSB7DQoJCQkJCWNvbHVtbnM6IFtdLA0KCQkJCQlwb3NpdGlvbjogLTENCgkJCQl9Ow0KDQoJCQkJJCgnPiBsaS5tZW51LWl0ZW0nLCAkaXRlbSkucmVtb3ZlQ2xhc3MoJ21lZ2FtZW51LW5vLXJpZ2h0LWJvcmRlcicpLmVhY2goZnVuY3Rpb24oKSB7DQoJCQkJCXZhciBwb3MgPSAkKHRoaXMpLnBvc2l0aW9uKCk7DQoJCQkJCXZhciBjb2x1bW5fcmlnaHRfcG9zaXRpb24gPSBwb3MubGVmdCArICQodGhpcykud2lkdGgoKTsNCg0KCQkJCQlpZiAoY29sdW1uX3JpZ2h0X3Bvc2l0aW9uID4gbWF4X3JpZ2h0cy5wb3NpdGlvbikgew0KCQkJCQkJbWF4X3JpZ2h0cy5wb3NpdGlvbiA9IGNvbHVtbl9yaWdodF9wb3NpdGlvbjsNCgkJCQkJCW1heF9yaWdodHMuY29sdW1ucyA9IFtdOw0KCQkJCQl9DQoNCgkJCQkJaWYgKGNvbHVtbl9yaWdodF9wb3NpdGlvbiA9PSBtYXhfcmlnaHRzLnBvc2l0aW9uKSB7DQoJCQkJCQltYXhfcmlnaHRzLmNvbHVtbnMucHVzaCgkKHRoaXMpKTsNCgkJCQkJfQ0KCQkJCX0pOw0KDQoJCQkJaWYgKG1heF9yaWdodHMuY29sdW1ucy5sZW5ndGggJiYgbWF4X3JpZ2h0cy5wb3NpdGlvbiA+PSAobWVnYV93aWR0aCAtIDcpKSB7DQoJCQkJCW1heF9yaWdodHMuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKCRsaSkgew0KCQkJCQkJJGxpLmFkZENsYXNzKCdtZWdhbWVudS1uby1yaWdodC1ib3JkZXInKTsNCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfQ0KDQoJCQlpZiAoaXNWZXJ0aWNhbE1lbnUgfHwgaXNIYW1idXJnZXJNZW51IHx8IGlzUGVyc3BlY3RpdmVNZW51KSB7DQoJCQkJdmFyIGNsaWVudEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0LA0KCQkJCQlpdGVtT2Zmc2V0ID0gJGl0ZW0ub2Zmc2V0KCksDQoJCQkJCWl0ZW1IZWlnaHQgPSAkaXRlbS5vdXRlckhlaWdodCgpLA0KCQkJCQlzY3JvbGxUb3AgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7DQoNCgkJCQlpZiAoaXRlbU9mZnNldC50b3AgLSBzY3JvbGxUb3AgKyBpdGVtSGVpZ2h0ID4gY2xpZW50SGVpZ2h0KSB7DQoJCQkJCSRpdGVtLmNzcyh7DQoJCQkJCQl0b3A6IGNsaWVudEhlaWdodCAtIGl0ZW1PZmZzZXQudG9wICsgc2Nyb2xsVG9wIC0gaXRlbUhlaWdodCAtIDIwDQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0NCg0KCQkJJGl0ZW0uYWRkQ2xhc3MoJ21lZ2FtZW51LWluaXRlZCcpOw0KCX0NCg0KCWZ1bmN0aW9uIHByaW1hcnlfbWVudV9yZWluaXQoKSB7DQoJCWlmKGlzUmVzcG9uc2l2ZU1lbnVWaXNpYmxlKCkpIHsNCgkJCWlmICh3aW5kb3cuZ2VtTW9iaWxlTWVudVR5cGUgPT0gJ2RlZmF1bHQnKSB7DQoJCQkJdmFyICRzdWJtZW51RGlzYWJsZWQgPSAkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uIC5kbC1zdWJtZW51LWRpc2FibGVkJyk7DQoJCQkJaWYgKCRzdWJtZW51RGlzYWJsZWQubGVuZ3RoKSB7DQoJCQkJCSRzdWJtZW51RGlzYWJsZWQuYWRkQ2xhc3MoJ2RsLXN1Ym1lbnUnKS5yZW1vdmVDbGFzcygnZGwtc3VibWVudS1kaXNhYmxlZCcpOw0KCQkJCX0NCgkJCX0NCgkJCWlmICgkKCcjcHJpbWFyeS1tZW51JykuaGFzQ2xhc3MoJ25vLXJlc3BvbnNpdmUnKSkgew0KCQkJCSQoJyNwcmltYXJ5LW1lbnUnKS5yZW1vdmVDbGFzcygnbm8tcmVzcG9uc2l2ZScpOw0KCQkJfQ0KCQkJaWYgKCEkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uJykuaGFzQ2xhc3MoJ3Jlc3BvbnNpdmUnKSkgew0KCQkJCSQoJyNwcmltYXJ5LW5hdmlnYXRpb24nKS5hZGRDbGFzcygncmVzcG9uc2l2ZScpOw0KCQkJfQ0KCQkJJCgnLm1lbnUtb3ZlcmxheScpLmFkZENsYXNzKCdtb2JpbGUnKTsNCgkJCXdpbmRvdy5maXhNZW51TG9nb1Bvc2l0aW9uKCk7DQoJCX0gZWxzZSB7DQoJCQlpZiAod2luZG93LmdlbU1vYmlsZU1lbnVUeXBlID09ICdvdmVybGF5JyAmJiAhJCgnLmhlYWRlci1sYXlvdXQtb3ZlcmxheScpLmxlbmd0aCAmJiAkKCcubWVudS1vdmVybGF5JykuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7DQoJCQkJJCgnLm1vYmlsZS1tZW51LWxheW91dC1vdmVybGF5IC5tZW51LXRvZ2dsZScpLmNsaWNrKCk7DQoJCQl9DQoNCgkJCSQoJyNwcmltYXJ5LW5hdmlnYXRpb24nKS5hZGRDbGFzcygnd2l0aG91dC10cmFuc2l0aW9uJyk7DQoNCgkJCWlmICh3aW5kb3cuZ2VtTW9iaWxlTWVudVR5cGUgPT0gJ2RlZmF1bHQnKSB7DQoJCQkJJCgnI3ByaW1hcnktbmF2aWdhdGlvbiAuZGwtc3VibWVudScpLmFkZENsYXNzKCdkbC1zdWJtZW51LWRpc2FibGVkJykucmVtb3ZlQ2xhc3MoJ2RsLXN1Ym1lbnUnKTsNCgkJCX0NCgkJCSQoJyNwcmltYXJ5LW1lbnUnKS5hZGRDbGFzcygnbm8tcmVzcG9uc2l2ZScpOw0KCQkJJCgnI3ByaW1hcnktbmF2aWdhdGlvbicpLnJlbW92ZUNsYXNzKCdyZXNwb25zaXZlJyk7DQoJCQkkKCcubWVudS1vdmVybGF5JykucmVtb3ZlQ2xhc3MoJ21vYmlsZScpOw0KDQoJCQl3aW5kb3cuZml4TWVudUxvZ29Qb3NpdGlvbigpOw0KDQoJCQkkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uJykucmVtb3ZlQ2xhc3MoJ3dpdGhvdXQtdHJhbnNpdGlvbicpOw0KCQl9DQoJfQ0KDQoJaWYgKHdpbmRvdy5nZW1Nb2JpbGVNZW51VHlwZSA9PSAnZGVmYXVsdCcpIHsNCgkJJCgnI3ByaW1hcnktbmF2aWdhdGlvbiAuc3VibWVudS1sYW5ndWFnZXMnKS5hZGRDbGFzcygnZGwtc3VibWVudScpOw0KCX0NCgkkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uID4gdWw+IGxpLm1lbnUtaXRlbS1sYW5ndWFnZScpLmFkZENsYXNzKCdtZW51LWl0ZW0tcGFyZW50Jyk7DQoNCglmaXhNZWdhTWVudVdpdGhTZXR0aW5ncygpOw0KDQoJaWYgKHdpbmRvdy5nZW1Nb2JpbGVNZW51VHlwZSA9PSAnZGVmYXVsdCcpIHsNCgkJdmFyIHVwZGF0ZU1vYmlsZU1lbnVQb3NpdGlvbiA9IGZ1bmN0aW9uKCkgew0KCQkJdmFyIHNpdGVIZWFkZXJIZWlnaHQgPSAkKCcjc2l0ZS1oZWFkZXInKS5vdXRlckhlaWdodCgpLA0KCQkJCXdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0Ow0KDQoJCQlpZiAoJCgnI3RoZWdlbS1wZXJzcGVjdGl2ZSAjcHJpbWFyeS1tZW51JykubGVuZ3RoKSB7DQoJCQkJJCgnI3RoZWdlbS1wZXJzcGVjdGl2ZSA+IC5tb2JpbGUtbWVudS1sYXlvdXQtZGVmYXVsdCcpLmNzcyh7DQoJCQkJCXRvcDogc2l0ZUhlYWRlckhlaWdodA0KCQkJCX0pOw0KCQkJfQ0KDQoJCQkkKCcjcHJpbWFyeS1tZW51JykuY3NzKHsNCgkJCQltYXhIZWlnaHQ6IHdpbmRvd0hlaWdodCAtIHNpdGVIZWFkZXJIZWlnaHQNCgkJCX0pOw0KCQl9Ow0KDQoJCSQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7DQoJCQlpZiAoaXNSZXNwb25zaXZlTWVudVZpc2libGUoKSAmJiAkKCcjcHJpbWFyeS1tZW51JykuaGFzQ2xhc3MoJ2RsLW1lbnVvcGVuJykpIHsNCgkJCQlzZXRUaW1lb3V0KHVwZGF0ZU1vYmlsZU1lbnVQb3NpdGlvbiwgNTApOw0KCQkJfSBlbHNlIHsNCgkJCQkkKCcjcHJpbWFyeS1tZW51JykuY3NzKHsNCgkJCQkJbWF4SGVpZ2h0OiAnJw0KCQkJCX0pOw0KCQkJfQ0KCQl9KTsNCg0KCQkkKCcjc2l0ZS1oZWFkZXIgLmRsLXRyaWdnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHsNCgkJCXVwZGF0ZU1vYmlsZU1lbnVQb3NpdGlvbigpOw0KCQl9KTsNCg0KCQkkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uJykuZGxtZW51KHsNCgkJCWFuaW1hdGlvbkNsYXNzZXM6IHsNCgkJCQljbGFzc2luIDogJ2RsLWFuaW1hdGUtaW4nLA0KCQkJCWNsYXNzb3V0IDogJ2RsLWFuaW1hdGUtb3V0Jw0KCQkJfSwNCgkJCW9uTGV2ZWxDbGljazogZnVuY3Rpb24gKGVsLCBuYW1lKSB7DQoJCQkJLy8kKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7IHNjcm9sbFRvcCA6IDAgfSk7DQoJCQl9LA0KCQkJYmFja0xhYmVsOiB0aGVnZW1fZGxtZW51X3NldHRpbmdzLmJhY2tMYWJlbCwNCgkJCXNob3dDdXJyZW50TGFiZWw6IHRoZWdlbV9kbG1lbnVfc2V0dGluZ3Muc2hvd0N1cnJlbnRMYWJlbA0KCQl9KTsNCgl9DQoJcHJpbWFyeV9tZW51X3JlaW5pdCgpOw0KDQoJJCgnI3ByaW1hcnktbWVudSA+IGxpJykuaG92ZXIoDQoJCWZ1bmN0aW9uKCkgew0KCQkJdmFyICRpdGVtcyA9ICQoJ3VsOm5vdCgubWluaWNhcnQgdWwpLCAubWluaWNhcnQsIC5taW5pc2VhcmNoJywgdGhpcyk7DQoJCQkkaXRlbXMucmVtb3ZlQ2xhc3MoJ2ludmVydCB2ZXJ0aWNhbC1pbnZlcnQnKTsNCg0KCQkJaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdtZWdhbWVudS1lbmFibGUnKSkgew0KCQkJCSRpdGVtcy5jc3Moe3RvcDogJyd9KTsNCgkJCX0NCg0KCQkJaWYgKCQodGhpcykuaGFzQ2xhc3MoJ21lZ2FtZW51LWVuYWJsZScpIHx8DQoJCQkJCSQodGhpcykuY2xvc2VzdCgnLmhlYWRlci1sYXlvdXQtb3ZlcmxheScpLmxlbmd0aCB8fA0KCQkJCQkkKHRoaXMpLmNsb3Nlc3QoJy5tb2JpbGUtbWVudS1sYXlvdXQtb3ZlcmxheScpLmxlbmd0aCAmJiBpc1Jlc3BvbnNpdmVNZW51VmlzaWJsZSgpKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQl2YXIgdG9wSXRlbVRyYW5zbGF0ZSA9IDA7DQoJCQlpZiAoJCgnPnVsJywgdGhpcykuY3NzKCd0cmFuc2Zvcm0nKSkgew0KCQkJCXRvcEl0ZW1UcmFuc2xhdGUgPSBwYXJzZUludCgkKCc+dWwnLCB0aGlzKS5jc3MoJ3RyYW5zZm9ybScpLnNwbGl0KCcsJylbNV0pOw0KCQkJfQ0KCQkJaWYgKGlzTmFOKHRvcEl0ZW1UcmFuc2xhdGUpKSB7DQoJCQkJdG9wSXRlbVRyYW5zbGF0ZSA9IDA7DQoJCQl9DQoJCQl2YXIgd2luZG93U2Nyb2xsID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpLA0KCQkJCXNpdGVIZWFkZXJPZmZzZXQgPSAkKCcjc2l0ZS1oZWFkZXInKS5vZmZzZXQoKSwNCgkJCQlzaXRlSGVhZGVyT2Zmc2V0VG9wID0gc2l0ZUhlYWRlck9mZnNldC50b3AgLSB3aW5kb3dTY3JvbGwsDQoJCQkJc2l0ZUhlYWRlckhlaWdodCA9ICQoJyNzaXRlLWhlYWRlcicpLm91dGVySGVpZ2h0KCk7DQoNCgkJCSRpdGVtcy5lYWNoKGZ1bmN0aW9uKCkgew0KCQkgICAgICAgIHZhciAkaXRlbSA9ICQodGhpcyk7DQoJCSAgICAgICAgdmFyIHNlbGYgPSB0aGlzOw0KDQoJCQkJdmFyIGl0ZW1PZmZzZXQgPSAkaXRlbS5vZmZzZXQoKSwNCgkJCQkJaXRlbU9mZnNldFRvcCA9IGl0ZW1PZmZzZXQudG9wIC0gd2luZG93U2Nyb2xsLA0KCQkJCQlpdGVtT2Zmc2V0TGVmdCA9IGl0ZW1PZmZzZXQubGVmdDsNCg0KCQkJCWlmKGl0ZW1PZmZzZXRMZWZ0IC0gJCgnI3BhZ2UnKS5vZmZzZXQoKS5sZWZ0ICsgJGl0ZW0ub3V0ZXJXaWR0aCgpID4gJCgnI3BhZ2UnKS53aWR0aCgpKSB7DQoJCQkJCSRpdGVtLmFkZENsYXNzKCdpbnZlcnQnKTsNCgkJCQl9DQoNCgkJCQlpZiAoaXNWZXJ0aWNhbE1lbnUgfHwgaXNQZXJzcGVjdGl2ZU1lbnUgfHwgaXNIYW1idXJnZXJNZW51KSB7DQoJCQkJCWlmIChpdGVtT2Zmc2V0VG9wIC0gdG9wSXRlbVRyYW5zbGF0ZSArICRpdGVtLm91dGVySGVpZ2h0KCkgPiAkKHdpbmRvdykuaGVpZ2h0KCkpIHsNCgkJCQkJCSRpdGVtLmFkZENsYXNzKCd2ZXJ0aWNhbC1pbnZlcnQnKTsNCgkJCQkJCXZhciBpdGVtT2Zmc2V0Rml4ID0gaXRlbU9mZnNldFRvcCAgLSB0b3BJdGVtVHJhbnNsYXRlICsgJGl0ZW0ub3V0ZXJIZWlnaHQoKSAtICQod2luZG93KS5oZWlnaHQoKTsNCgkJCQkJCWlmIChpdGVtT2Zmc2V0VG9wIC0gdG9wSXRlbVRyYW5zbGF0ZSAtIGl0ZW1PZmZzZXRGaXggPCAwKSB7DQoJCQkJCQkJaXRlbU9mZnNldEZpeCA9IDA7DQoJCQkJCQl9DQoJCQkJCQkkaXRlbS5jc3MoeyB0b3A6IC1pdGVtT2Zmc2V0Rml4ICsgJ3B4JyB9KTsNCgkJCQkJfQ0KCQkJCX0gZWxzZSB7DQoJCQkJCWlmIChpdGVtT2Zmc2V0VG9wIC0gdG9wSXRlbVRyYW5zbGF0ZSArICRpdGVtLm91dGVySGVpZ2h0KCkgPiAkKHdpbmRvdykuaGVpZ2h0KCkpIHsNCgkJCQkJCSRpdGVtLmFkZENsYXNzKCd2ZXJ0aWNhbC1pbnZlcnQnKTsNCgkJCQkJCXZhciBpdGVtT2Zmc2V0Rml4ID0gaXRlbU9mZnNldFRvcCAgLSB0b3BJdGVtVHJhbnNsYXRlICsgJGl0ZW0ub3V0ZXJIZWlnaHQoKSAtICQod2luZG93KS5oZWlnaHQoKTsNCgkJCQkJCWlmIChpdGVtT2Zmc2V0VG9wIC0gdG9wSXRlbVRyYW5zbGF0ZSAtIGl0ZW1PZmZzZXRGaXggPCBzaXRlSGVhZGVyT2Zmc2V0VG9wICsgc2l0ZUhlYWRlckhlaWdodCkgew0KCQkJCQkJCWl0ZW1PZmZzZXRGaXggLT0gc2l0ZUhlYWRlck9mZnNldFRvcCArIHNpdGVIZWFkZXJIZWlnaHQgLSAoaXRlbU9mZnNldFRvcCAtIHRvcEl0ZW1UcmFuc2xhdGUgLSBpdGVtT2Zmc2V0Rml4KTsNCgkJCQkJCQlpZiAoaXRlbU9mZnNldEZpeCA8IDApIHsNCgkJCQkJCQkJaXRlbU9mZnNldEZpeCA9IDA7DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQkJJGl0ZW0uY3NzKHsgdG9wOiAtaXRlbU9mZnNldEZpeCArICdweCcgfSk7DQoJCQkJCX0NCgkJCQl9DQoJCSAgICB9KTsNCgkJfSwNCgkJZnVuY3Rpb24oKSB7fQ0KCSk7DQoNCgkkKCcuaGFtYnVyZ2VyLXRvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uKGUpIHsNCgkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkkKHRoaXMpLmNsb3Nlc3QoJyNwcmltYXJ5LW5hdmlnYXRpb24nKS50b2dnbGVDbGFzcygnaGFtYnVyZ2VyLWFjdGl2ZScpOw0KCQkkKCcuaGFtYnVyZ2VyLW92ZXJsYXknKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7DQoJfSk7DQoNCgkkKCcub3ZlcmxheS10b2dnbGUsICNoZWFkZXIgLm1lbnUtdG9nZ2xlJykuY2xpY2soZnVuY3Rpb24oZSkgew0KICAgICAgICBjb25zb2xlLmxvZygibWVudS10b2dnbGUiKQ0KCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCWlmKCQoJy5tZW51LW92ZXJsYXknKS5oYXNDbGFzcygnYWN0aXZlJykpIHsNCgkJCSQoJy5tZW51LW92ZXJsYXknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7DQoJCQkkKCcucHJpbWFyeS1uYXZpZ2F0aW9uJykuYWRkQ2xhc3MoJ2Nsb3NlJyk7DQoJCQkkKCcucHJpbWFyeS1uYXZpZ2F0aW9uJykub25lKCd3ZWJraXRUcmFuc2l0aW9uRW5kIG90cmFuc2l0aW9uZW5kIG9UcmFuc2l0aW9uRW5kIG1zVHJhbnNpdGlvbkVuZCB0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24oZSkgew0KCQkJCSQoJy5wcmltYXJ5LW5hdmlnYXRpb24nKS5yZW1vdmVDbGFzcygnb3ZlcmxheS1hY3RpdmUgY2xvc2UnKTsNCgkJCQkkKCcub3ZlcmxheS1tZW51LXdyYXBwZXInKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7DQoJCQl9KTsNCgkJfSBlbHNlIHsNCgkJCSQoJy5vdmVybGF5LW1lbnUtd3JhcHBlcicpLmFkZENsYXNzKCdhY3RpdmUnKTsNCgkJCSQoJy5wcmltYXJ5LW5hdmlnYXRpb24nKS5vZmYoJ3dlYmtpdFRyYW5zaXRpb25FbmQgb3RyYW5zaXRpb25lbmQgb1RyYW5zaXRpb25FbmQgbXNUcmFuc2l0aW9uRW5kIHRyYW5zaXRpb25lbmQnKTsNCgkJCSQoJy5wcmltYXJ5LW5hdmlnYXRpb24nKS5hZGRDbGFzcygnb3ZlcmxheS1hY3RpdmUnKS5yZW1vdmVDbGFzcygnY2xvc2UnKTsNCgkJCWlmIChpc1Jlc3BvbnNpdmVNZW51VmlzaWJsZSgpKSB7DQoJCQkJJCgnI3NpdGUtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpOw0KCQkJCSQoJy5tZW51LW92ZXJsYXknKS5hZGRDbGFzcygnbW9iaWxlJyk7DQoJCQl9IGVsc2Ugew0KCQkJCSQoJy5tZW51LW92ZXJsYXknKS5yZW1vdmVDbGFzcygnbW9iaWxlJyk7DQoJCQl9DQoJCQkkKCcubWVudS1vdmVybGF5JykuYWRkQ2xhc3MoJ2FjdGl2ZScpOw0KCQl9DQoJfSk7DQoNCgkkKCcubW9iaWxlLW1lbnUtbGF5b3V0LXNsaWRlLWhvcml6b250YWwgLnByaW1hcnktbmF2aWdhdGlvbiAjcHJpbWFyeS1tZW51IGxpLm1lbnUtaXRlbS1jdXJyZW50LCAubW9iaWxlLW1lbnUtbGF5b3V0LXNsaWRlLXZlcnRpY2FsIC5wcmltYXJ5LW5hdmlnYXRpb24gI3ByaW1hcnktbWVudSBsaS5tZW51LWl0ZW0tY3VycmVudCcpLmVhY2goZnVuY3Rpb24oKSB7DQoJCSQodGhpcykuYWRkQ2xhc3MoJ29wZW5lZCcpOw0KCQkkKCc+IHVsJywgdGhpcykuc2hvdygpOw0KCX0pOw0KDQoJJCgnLm1vYmlsZS1tZW51LWxheW91dC1zbGlkZS1ob3Jpem9udGFsIC5tZW51LXRvZ2dsZSwgLm1vYmlsZS1tZW51LWxheW91dC1zbGlkZS12ZXJ0aWNhbCAubWVudS10b2dnbGUsIC5tb2JpbGUtbWVudS1zbGlkZS13cmFwcGVyIC5tb2JpbGUtbWVudS1zbGlkZS1jbG9zZScpLmNsaWNrKGZ1bmN0aW9uKGUpIHsNCgkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkkKCcjc2l0ZS1oZWFkZXInKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7DQoJCSQoJy5tb2JpbGUtbWVudS1zbGlkZS13cmFwcGVyJykub25lKCd3ZWJraXRUcmFuc2l0aW9uRW5kIG90cmFuc2l0aW9uZW5kIG9UcmFuc2l0aW9uRW5kIG1zVHJhbnNpdGlvbkVuZCB0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24oZSkgew0KCQkJJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0aW9uJyk7DQoJCX0pOw0KCQkkKCcubW9iaWxlLW1lbnUtc2xpZGUtd3JhcHBlcicpLmFkZENsYXNzKCdhbmltYXRpb24nKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7DQoJfSk7DQoNCgkkKCcubW9iaWxlLW1lbnUtbGF5b3V0LXNsaWRlLWhvcml6b250YWwgLnByaW1hcnktbmF2aWdhdGlvbiAjcHJpbWFyeS1tZW51IC5tZW51LWl0ZW0tcGFyZW50LXRvZ2dsZSwgLm1vYmlsZS1tZW51LWxheW91dC1zbGlkZS12ZXJ0aWNhbCAucHJpbWFyeS1uYXZpZ2F0aW9uICNwcmltYXJ5LW1lbnUgLm1lbnUtaXRlbS1wYXJlbnQtdG9nZ2xlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgew0KCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCXZhciBzZWxmID0gdGhpczsNCgkJJCh0aGlzKS5jbG9zZXN0KCdsaScpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTsNCgkJJCh0aGlzKS5zaWJsaW5ncygndWwnKS5zbGlkZVRvZ2dsZSgyMDAsIGZ1bmN0aW9uKCkgew0KCQkJaWYgKCEkKHNlbGYpLmNsb3Nlc3QoJ2xpJykuaGFzQ2xhc3MoJ29wZW5lZCcpKSB7DQoJCQkJJChzZWxmKS5zaWJsaW5ncygndWwnKS5maW5kKCdsaScpLnJlbW92ZUNsYXNzKCdvcGVuZWQnKTsNCgkJCQkkKHNlbGYpLnNpYmxpbmdzKCd1bCcpLmNzcygnZGlzcGxheScsICcnKTsNCgkJCQkkKHNlbGYpLnNpYmxpbmdzKCd1bCcpLmZpbmQoJ3VsJykuY3NzKCdkaXNwbGF5JywgJycpOw0KCQkJfQ0KCQl9KTsNCgl9KTsNCg0KCSQoJy5oZWFkZXItbGF5b3V0LW92ZXJsYXkgI3ByaW1hcnktbWVudSBhLCAubW9iaWxlLW1lbnUtbGF5b3V0LW92ZXJsYXkgLnByaW1hcnktbmF2aWdhdGlvbiAjcHJpbWFyeS1tZW51IC5tZW51LWl0ZW0tcGFyZW50LXRvZ2dsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHsNCgkJLy9pZighJCgnI3ByaW1hcnktbWVudScpLmhhc0NsYXNzKCduby1yZXNwb25zaXZlJykpIHJldHVybiA7DQoNCgkJaWYgKCEkKCcjcHJpbWFyeS1tZW51JykuaGFzQ2xhc3MoJ25vLXJlc3BvbnNpdmUnKSAmJiAhJCh0aGlzKS5oYXNDbGFzcygnbWVudS1pdGVtLXBhcmVudC10b2dnbGUnKSkgew0KCQkJcmV0dXJuOw0KCQl9DQoNCgkJdmFyICRpdGVtTGluayA9ICQodGhpcyk7DQoJCXZhciAkaXRlbSA9ICRpdGVtTGluay5jbG9zZXN0KCdsaScpOw0KCQlpZigkaXRlbS5oYXNDbGFzcygnbWVudS1pdGVtLXBhcmVudCcpICYmICgkaXRlbS5jbG9zZXN0KCd1bCcpLmhhc0NsYXNzKCduYXYtbWVudScpIHx8ICRpdGVtLnBhcmVudCgpLmNsb3Nlc3QoJ2xpJykuaGFzQ2xhc3MoJ21lbnUtb3ZlcmxheS1pdGVtLW9wZW4nKSkpIHsNCgkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCWlmKCRpdGVtLmhhc0NsYXNzKCdtZW51LW92ZXJsYXktaXRlbS1vcGVuJykpIHsNCgkJCQkkKCcgPiB1bCwgLm1lbnUtb3ZlcmxheS1pdGVtLW9wZW4gPiB1bCcsICRpdGVtKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJCQkkKHRoaXMpLmNzcyh7aGVpZ2h0OiAkKHRoaXMpLm91dGVySGVpZ2h0KCkrJ3B4J30pOw0KCQkJCX0pOw0KCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJCSQoJyA+IHVsLCAubWVudS1vdmVybGF5LWl0ZW0tb3BlbiA+IHVsJywgJGl0ZW0pLmNzcyh7aGVpZ2h0OiAnJ30pOw0KCQkJCQkkKCcubWVudS1vdmVybGF5LWl0ZW0tb3BlbicsICRpdGVtKS5hZGQoJGl0ZW0pLnJlbW92ZUNsYXNzKCdtZW51LW92ZXJsYXktaXRlbS1vcGVuJyk7DQoJCQkJfSwgNTApOw0KCQkJfSBlbHNlIHsNCgkJCQl2YXIgJG9sZEFjdGl2ZSA9ICQoJy5wcmltYXJ5LW5hdmlnYXRpb24gLm1lbnUtb3ZlcmxheS1pdGVtLW9wZW4nKS5ub3QoJGl0ZW0ucGFyZW50cygpKTsNCgkJCQkkKCc+IHVsJywgJG9sZEFjdGl2ZSkubm90KCRpdGVtLnBhcmVudHMoKSkuZWFjaChmdW5jdGlvbigpIHsNCgkJCQkJJCh0aGlzKS5jc3Moe2hlaWdodDogJCh0aGlzKS5vdXRlckhlaWdodCgpKydweCd9KTsNCgkJCQl9KTsNCgkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KCQkJCQkkKCc+IHVsJywgJG9sZEFjdGl2ZSkubm90KCRpdGVtLnBhcmVudHMoKSkuY3NzKHtoZWlnaHQ6ICcnfSk7DQoJCQkJCSRvbGRBY3RpdmUucmVtb3ZlQ2xhc3MoJ21lbnUtb3ZlcmxheS1pdGVtLW9wZW4nKTsNCgkJCQl9LCA1MCk7DQoJCQkJJCgnPiB1bCcsICRpdGVtKS5jc3Moe2hlaWdodDogJ2F1dG8nfSk7DQoJCQkJdmFyIGl0ZW1IZWlnaHQgPSAkKCc+IHVsJywgJGl0ZW0pLm91dGVySGVpZ2h0KCk7DQoJCQkJJCgnPiB1bCcsICRpdGVtKS5jc3Moe2hlaWdodDogJyd9KTsNCgkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KCQkJCQkkKCc+IHVsJywgJGl0ZW0pLmNzcyh7aGVpZ2h0OiBpdGVtSGVpZ2h0KydweCd9KTsNCgkJCQkJJGl0ZW0uYWRkQ2xhc3MoJ21lbnUtb3ZlcmxheS1pdGVtLW9wZW4nKTsNCgkJCQkJJCgnPiB1bCcsICRpdGVtKS5vbmUoJ3dlYmtpdFRyYW5zaXRpb25FbmQgb3RyYW5zaXRpb25lbmQgb1RyYW5zaXRpb25FbmQgbXNUcmFuc2l0aW9uRW5kIHRyYW5zaXRpb25lbmQnLCBmdW5jdGlvbigpIHsNCgkJCQkJCSQoJz4gdWwnLCAkaXRlbSkuY3NzKHtoZWlnaHQ6ICdhdXRvJ30pOw0KCQkJCQl9KTsNCgkJCQl9LCA1MCk7DQoJCQl9DQoJCX0NCgl9KTsNCg0KCSQoJy52ZXJ0aWNhbC10b2dnbGUnKS5jbGljayhmdW5jdGlvbihlKSB7DQoJCWUucHJldmVudERlZmF1bHQoKTsNCgkJJCh0aGlzKS5jbG9zZXN0KCcjc2l0ZS1oZWFkZXItd3JhcHBlcicpLnRvZ2dsZUNsYXNzKCd2ZXJ0aWNhbC1hY3RpdmUnKTsNCgl9KTsNCg0KCSQoZnVuY3Rpb24oKSB7DQoJCSQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7DQoJCQlpZiAod2luZG93Lm1lbnVSZXNpemVUaW1lb3V0SGFuZGxlcikgew0KCQkJCWNsZWFyVGltZW91dCh3aW5kb3cubWVudVJlc2l6ZVRpbWVvdXRIYW5kbGVyKTsNCgkJCX0NCgkJCXdpbmRvdy5tZW51UmVzaXplVGltZW91dEhhbmRsZXIgPSBzZXRUaW1lb3V0KHByaW1hcnlfbWVudV9yZWluaXQsIDUwKTsNCgkJfSk7DQoJfSk7DQoNCgkkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uIGEnKS5jbGljayhmdW5jdGlvbihlKSB7DQoJCXZhciAkaXRlbSA9ICQodGhpcyk7DQoJCWlmKCQoJyNwcmltYXJ5LW1lbnUnKS5oYXNDbGFzcygnbm8tcmVzcG9uc2l2ZScpICYmIHdpbmRvdy5nZW1TZXR0aW5ncy5pc1RvdWNoICYmICRpdGVtLm5leHQoJ3VsJykubGVuZ3RoKSB7DQoJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCX0NCgl9KTsNCn0pKGpRdWVyeSk7DQoNCi8vIE1lbnUgcGVyc3BlY3RpdmUNCihmdW5jdGlvbigkKSB7DQoJdmFyIHRyYW5zaXRpb25FbmRFdmVudCA9IHsNCgkJCSdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLA0KCQkJJ01velRyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcsDQoJCQknT1RyYW5zaXRpb24nOiAnb1RyYW5zaXRpb25FbmQnLA0KCQkJJ21zVHJhbnNpdGlvbic6ICdNU1RyYW5zaXRpb25FbmQnLA0KCQkJJ3RyYW5zaXRpb24nOiAndHJhbnNpdGlvbmVuZCcNCiAgICAJfVsgd2luZG93LnN1cHBvcnRlZFRyYW5zaXRpb24gXSwNCgkJY2xpY2tFdmVudE5hbWUgPSAnY2xpY2snOw0KDQoJZnVuY3Rpb24gaW5pdFBlcnNwZWN0aXZlKCkgew0KCQl2YXIgJG1lbnVUb2dnbGVCdXR0b24gPSAkKCcucGVyc3BlY3RpdmUtdG9nZ2xlJyksDQoJCQkkcGVyc3BlY3RpdmUgPSAkKCcjdGhlZ2VtLXBlcnNwZWN0aXZlJyksDQoJCQkkcGFnZSA9ICQoJyNwYWdlJyk7DQoNCgkJaWYgKCEkcGVyc3BlY3RpdmUubGVuZ3RoKSB7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCg0KCQkkbWVudVRvZ2dsZUJ1dHRvbi5vbihjbGlja0V2ZW50TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHsNCgkJCWlmICgkcGVyc3BlY3RpdmUuaGFzQ2xhc3MoJ2FuaW1hdGUnKSkgew0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJdmFyIGRvY3VtZW50U2Nyb2xsVG9wID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpOw0KCQkJJCh3aW5kb3cpLnNjcm9sbFRvcCgwKTsNCg0KCQkJdmFyIHBhZ2VXaWR0aCA9ICRwYWdlLm91dGVyV2lkdGgoKSwNCgkJCQlwZXJzcGVjdGl2ZVdpZHRoID0gJHBlcnNwZWN0aXZlLm91dGVyV2lkdGgoKSwNCgkJCQlwYWdlQ3NzID0gew0KCQkJCQl3aWR0aDogcGFnZVdpZHRoDQoJCQkJfTsNCg0KCQkJaWYgKHBhZ2VXaWR0aCA8IHBlcnNwZWN0aXZlV2lkdGgpIHsNCgkJCQlwYWdlQ3NzLm1hcmdpbkxlZnQgPSAkcGFnZVswXS5vZmZzZXRMZWZ0Ow0KCQkJfQ0KDQoJCQkkcGFnZS5jc3MocGFnZUNzcyk7DQoNCgkJCSRwZXJzcGVjdGl2ZS5hZGRDbGFzcygnbW9kYWx2aWV3IGFuaW1hdGUnKTsNCgkJCSRwYWdlLnNjcm9sbFRvcChkb2N1bWVudFNjcm9sbFRvcCk7DQoJCQkvLyQod2luZG93KS50cmlnZ2VyKCdwZXJzcGVjdGl2ZS1tb2RhbHZpZXctb3BlbmVkJyk7DQoJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uID8gZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkgOiAoZXZlbnQuY2FuY2VsQnViYmxlPXRydWUpOw0KCQl9KTsNCg0KCQkkKCcjcHJpbWFyeS1uYXZpZ2F0aW9uJykub24oY2xpY2tFdmVudE5hbWUsIGZ1bmN0aW9uKGV2ZW50KSB7DQoJCQlpZiAoaXNSZXNwb25zaXZlTWVudVZpc2libGUoKSkgew0KCQkJCXJldHVybjsNCgkJCX0NCgkJCWV2ZW50LnN0b3BQcm9wYWdhdGlvbiA/IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpIDogKGV2ZW50LmNhbmNlbEJ1YmJsZT10cnVlKTsNCgkJfSk7DQoNCgkJJCgnI3RoZWdlbS1wZXJzcGVjdGl2ZSAucGVyc3BlY3RpdmUtbWVudS1jbG9zZScpLm9uKGNsaWNrRXZlbnROYW1lLCBmdW5jdGlvbihldmVudCkgew0KCQkJJHBlcnNwZWN0aXZlLmNsaWNrKCk7DQoJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uID8gZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkgOiAoZXZlbnQuY2FuY2VsQnViYmxlPXRydWUpOw0KCQl9KTsNCg0KCQkkcGVyc3BlY3RpdmUub24oY2xpY2tFdmVudE5hbWUsIGZ1bmN0aW9uKGV2ZW50KSB7DQoJCQlpZiAoISRwZXJzcGVjdGl2ZS5oYXNDbGFzcygnYW5pbWF0ZScpKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQl2YXIgb25FbmRUcmFuc2l0aW9uQ2FsbGJhY2sgPSBmdW5jdGlvbihldmVudCkgew0KCQkJCWlmICh3aW5kb3cuc3VwcG9ydHNUcmFuc2l0aW9ucyAmJiAoZXZlbnQub3JpZ2luYWxFdmVudC50YXJnZXQuaWQgIT09ICdwYWdlJyB8fCBldmVudC5vcmlnaW5hbEV2ZW50LnByb3BlcnR5TmFtZS5pbmRleE9mKCd0cmFuc2Zvcm0nICkgPT0gLTEpKSB7DQoJCQkJCXJldHVybjsNCgkJCQl9DQoNCgkJCQkkKHRoaXMpLm9mZih0cmFuc2l0aW9uRW5kRXZlbnQsIG9uRW5kVHJhbnNpdGlvbkNhbGxiYWNrKTsNCgkJCQl2YXIgcGFnZVNjcm9sbFRvcCA9ICRwYWdlLnNjcm9sbFRvcCgpOw0KCQkJCSRwZXJzcGVjdGl2ZS5yZW1vdmVDbGFzcygnbW9kYWx2aWV3Jyk7DQoJCQkJJHBhZ2UuY3NzKHsNCgkJCQkJd2lkdGg6ICcnLA0KCQkJCQltYXJnaW5MZWZ0OiAnJw0KCQkJCX0pOw0KCQkJCSQod2luZG93KS5zY3JvbGxUb3AocGFnZVNjcm9sbFRvcCk7DQoJCQkJJHBhZ2Uuc2Nyb2xsVG9wKDApOw0KCQkJCSQod2luZG93KS5yZXNpemUoKTsNCgkJCQkvLyQod2luZG93KS50cmlnZ2VyKCdwZXJzcGVjdGl2ZS1tb2RhbHZpZXctY2xvc2VkJyk7DQoJCQl9Ow0KDQoJCQlpZiAod2luZG93LnN1cHBvcnRzVHJhbnNpdGlvbnMpIHsNCgkJCQkkcGVyc3BlY3RpdmUub24odHJhbnNpdGlvbkVuZEV2ZW50LCBvbkVuZFRyYW5zaXRpb25DYWxsYmFjayk7DQoJCQl9IGVsc2Ugew0KCQkJCW9uRW5kVHJhbnNpdGlvbkNhbGxiYWNrLmNhbGwoKTsNCgkJCX0NCg0KCQkJJHBlcnNwZWN0aXZlLnJlbW92ZUNsYXNzKCdhbmltYXRlJyk7DQoJCX0pOw0KCX0NCg0KCWluaXRQZXJzcGVjdGl2ZSgpOw0KfSkoalF1ZXJ5KTsNCg==
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 29365
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20190618T104324Z
